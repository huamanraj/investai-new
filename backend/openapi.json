{"openapi":"3.1.0","info":{"title":"InvestAI","description":"AI-powered financial document analysis system","version":"0.1.0"},"paths":{"/api/projects":{"post":{"tags":["Projects"],"summary":"Create Project","description":"Create a new project from a BSE India URL with resumable processing","operationId":"create_project_api_projects_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Projects"],"summary":"List Projects","description":"List all projects","operationId":"list_projects_api_projects_get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}":{"get":{"tags":["Projects"],"summary":"Get Project","description":"Get project details with documents","operationId":"get_project_api_projects__project_id__get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectDetailResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Projects"],"summary":"Delete Project","description":"Delete a project and all associated data","operationId":"delete_project_api_projects__project_id__delete","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/status":{"get":{"tags":["Projects"],"summary":"Get Project Status","description":"Get project status","operationId":"get_project_status_api_projects__project_id__status_get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/snapshot":{"get":{"tags":["Projects"],"summary":"Get Project Snapshot","description":"Get company snapshot for a project.\nReturns comprehensive company overview with financials, charts, and analysis.","operationId":"get_project_snapshot_api_projects__project_id__snapshot_get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/cancel":{"post":{"tags":["Projects"],"summary":"Cancel Project Job","description":"Cancel a running job for a project.\nThe job can be resumed later from the last successful step.","operationId":"cancel_project_job_api_projects__project_id__cancel_post","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/resume":{"post":{"tags":["Projects"],"summary":"Resume Project Job","description":"Resume a failed or cancelled job from the last successful step.\nIf no job exists (e.g., background task crashed before creating job), starts a fresh job.\nAlso handles stale \"running\" jobs that were stopped unexpectedly.","operationId":"resume_project_job_api_projects__project_id__resume_post","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/progress-stream":{"get":{"tags":["Projects"],"summary":"Stream Project Progress","description":"Stream real-time progress updates for a project's processing job via SSE.\n\nUpdates include:\n- Validating link\n- Scraping page\n- Found PDFs\n- Downloading PDFs\n- Uploading to cloud\n- Extracting data\n- Creating embeddings\n- Generating snapshot\n- Completion status\n\nThe stream automatically closes when job completes, fails, or is cancelled.","operationId":"stream_project_progress_api_projects__project_id__progress_stream_get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/job":{"get":{"tags":["Projects"],"summary":"Get Project Job Details","description":"Get detailed job information for a project.\nShows current step, progress, and whether job can be resumed.","operationId":"get_project_job_details_api_projects__project_id__job_get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chats":{"post":{"tags":["chats"],"summary":"Create Chat","description":"Create a new chat session.\n\n- **title**: Optional chat title\n- **project_ids**: List of project UUIDs to start chatting with","operationId":"create_chat_api_chats_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["chats"],"summary":"List Chats","description":"List all chat sessions, ordered by most recent first.\n\n- **limit**: Maximum number of chats to return (default: 50)\n- **offset**: Offset for pagination (default: 0)","operationId":"list_chats_api_chats_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ChatResponse"},"title":"Response List Chats Api Chats Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chats/{chat_id}":{"get":{"tags":["chats"],"summary":"Get Chat","description":"Get chat details with all messages.\n\n- **chat_id**: Chat UUID","operationId":"get_chat_api_chats__chat_id__get","parameters":[{"name":"chat_id","in":"path","required":true,"schema":{"type":"string","title":"Chat Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatDetailResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["chats"],"summary":"Delete Chat","description":"Delete a chat and all its messages.\n\n- **chat_id**: Chat UUID","operationId":"delete_chat_api_chats__chat_id__delete","parameters":[{"name":"chat_id","in":"path","required":true,"schema":{"type":"string","title":"Chat Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chats/{chat_id}/messages":{"post":{"tags":["chats"],"summary":"Send Message","description":"Send a message and get streaming AI response via SSE.\n\n- **chat_id**: Chat UUID\n- **content**: Message content\n- **project_ids**: Selected project UUIDs for this message\n\nReturns: Server-Sent Events stream with AI response","operationId":"send_message_api_chats__chat_id__messages_post","parameters":[{"name":"chat_id","in":"path","required":true,"schema":{"type":"string","title":"Chat Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SendMessageRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health","description":"Health check endpoint","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ChatDetailResponse":{"properties":{"id":{"type":"string","title":"Id"},"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"created_at":{"type":"string","title":"Created At"},"messages":{"items":{"$ref":"#/components/schemas/MessageResponse"},"type":"array","title":"Messages"}},"type":"object","required":["id","title","created_at","messages"],"title":"ChatDetailResponse"},"ChatResponse":{"properties":{"id":{"type":"string","title":"Id"},"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"created_at":{"type":"string","title":"Created At"},"message_count":{"type":"integer","title":"Message Count"}},"type":"object","required":["id","title","created_at","message_count"],"title":"ChatResponse"},"CreateChatRequest":{"properties":{"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title","description":"Chat title (optional, auto-generated if not provided)"},"project_ids":{"items":{"type":"string"},"type":"array","minItems":1,"title":"Project Ids","description":"Initial project IDs to chat with"}},"type":"object","required":["project_ids"],"title":"CreateChatRequest"},"DocumentResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"document_type":{"type":"string","title":"Document Type"},"fiscal_year":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Fiscal Year"},"label":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Label"},"file_url":{"type":"string","title":"File Url"},"original_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Original Url"},"page_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Page Count"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","document_type","file_url","created_at"],"title":"DocumentResponse","description":"Schema for document response"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MessageResponse":{"properties":{"id":{"type":"string","title":"Id"},"role":{"type":"string","title":"Role"},"content":{"type":"string","title":"Content"},"project_ids":{"items":{"type":"string"},"type":"array","title":"Project Ids"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","role","content","project_ids","created_at"],"title":"MessageResponse"},"ProjectCreate":{"properties":{"source_url":{"type":"string","title":"Source Url","description":"BSE India annual reports URL","examples":["https://www.bseindia.com/stock-share-price/vimta-labs-ltd/vimtalabs/524394/financials-annual-reports/"]}},"type":"object","required":["source_url"],"title":"ProjectCreate","description":"Schema for creating a new project"},"ProjectDetailResponse":{"properties":{"project":{"$ref":"#/components/schemas/ProjectResponse"},"documents":{"items":{"$ref":"#/components/schemas/DocumentResponse"},"type":"array","title":"Documents"},"job_status":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Job Status"}},"type":"object","required":["project","documents"],"title":"ProjectDetailResponse","description":"Schema for project detail with documents"},"ProjectListResponse":{"properties":{"projects":{"items":{"$ref":"#/components/schemas/ProjectResponse"},"type":"array","title":"Projects"},"total":{"type":"integer","title":"Total"}},"type":"object","required":["projects","total"],"title":"ProjectListResponse","description":"Schema for listing projects"},"ProjectResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"company_name":{"type":"string","title":"Company Name"},"source_url":{"type":"string","title":"Source Url"},"exchange":{"type":"string","title":"Exchange"},"status":{"type":"string","title":"Status"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","company_name","source_url","exchange","status","created_at"],"title":"ProjectResponse","description":"Schema for project response"},"ProjectStatusResponse":{"properties":{"project":{"$ref":"#/components/schemas/ProjectResponse"},"job_status":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Job Status"}},"type":"object","required":["project"],"title":"ProjectStatusResponse","description":"Schema for project status with job info"},"SendMessageRequest":{"properties":{"content":{"type":"string","minLength":1,"title":"Content","description":"Message content"},"project_ids":{"items":{"type":"string"},"type":"array","minItems":1,"title":"Project Ids","description":"Selected project IDs"}},"type":"object","required":["content","project_ids"],"title":"SendMessageRequest"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}